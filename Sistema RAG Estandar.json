{
  "name": "Sistema RAG Estandar",
  "nodes": [
    {
      "parameters": {
        "content": "## Consumo de datos",
        "height": 672,
        "width": 768,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -336,
        -192
      ],
      "typeVersion": 1,
      "id": "a8797f59-3234-4308-a698-782f827954b6",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "formTitle": "Cargar Documentos",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Documentos",
              "fieldType": "file",
              "acceptFileTypes": ".pdf"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.5,
      "position": [
        -896,
        -96
      ],
      "id": "812c49f5-b7c7-4dbb-ac83-4f4aca9b0ba6",
      "name": "cargar_docs",
      "webhookId": "a0b75fa1-972c-4268-b498-fa8c125ea841"
    },
    {
      "parameters": {
        "mode": "insert",
        "memoryKey": {
          "__rl": true,
          "value": "vector_store_key",
          "mode": "list",
          "cachedResultName": "vector_store_key"
        },
        "embeddingBatchSize": 250
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.3,
      "position": [
        -736,
        -96
      ],
      "id": "0aa9f30a-872c-46a5-ba9d-6e5561546410",
      "name": "Simple Vector Store"
    },
    {
      "parameters": {
        "model": "embeddinggemma:300m"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
      "typeVersion": 1,
      "position": [
        -256,
        320
      ],
      "id": "f80559a6-5147-4772-a465-f787becc0f29",
      "name": "Embeddings Ollama",
      "credentials": {
        "ollamaApi": {
          "id": "xDcVkyu4yoySv92g",
          "name": "Credencial Ollama para localhost"
        }
      }
    },
    {
      "parameters": {
        "dataType": "binary",
        "textSplittingMode": "custom",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        -672,
        160
      ],
      "id": "645f799d-e94c-4a4c-bed9-4036afdffc98",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "chunkOverlap": 250,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        -704,
        336
      ],
      "id": "6c9969a3-76fe-4af6-968a-14fbd095320f",
      "name": "Recursive Character Text Splitter"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=# Rol: Asistente Legal\n\n## Descripción\n\nEres un asistente legal diseñado para ayudar a un abogado a consultar información contenida en documentos legales internos.\nDebes responder, analizar y entregar respuestas precisas, claras y fundamentadas basadas únicamente en los documentos disponibles.\nMantén siempre un tono profesional y formal, y prioriza la exactitud legal en todas tus respuestas.\n\nTus respuestas deben de ser cortas y puntuales.\n\nSi no conoces la respuesta, responde que no dispones de la información.\n\n## Capacidades\n\n- Búsqueda y recuperación de información legal relevante.\n- Respuestas concisas y con fundamento en los documentos disponibles.\n- Inclusión de referencia del documento utilizado para responder.\n- Identificación de ausencia de información en los documentos.\n- Mantener confidencialidad y precisión en todas las respuestas.\n\n## Comportamiento\n\n1. Recepción de la consulta: Recibe la pregunta o solicitud del abogado.\n2. Búsqueda de información en la base de conocimiento para encontrar información relevante en los documentos.\n3. Generación de la respuesta:\n   - Si encuentras la información:\n     - Proporciona un resumen conciso, claro y preciso.\n     - Incluye la referencia del documento donde encontraste la información (nombre o identificación del documento y sección/cláusula si aplica).\n   - Si no encuentras la información:\n     - Responde únicamente con:\n\n       No puedo encontrar la respuesta en los recursos disponibles\n\n4. Confidencialidad: No reveles información fuera de lo que esté contenido en los documentos.\n5. Tono: Profesional, formal, claro y directo.\n\n## Ejemplo\n\nPregunta del abogado:\n> ¿Cuál es el procedimiento de terminación anticipada del contrato de arrendamiento?\n\nRespuesta del asistente:\n> Según el Contrato de Arrendamiento – Cláusula 12, el contrato puede ser terminado anticipadamente por cualquiera de las partes notificando con al menos 30 días de antelación y cumpliendo con el pago proporcional de las obligaciones pendientes.\n> Referencia: Contrato Arrendamiento 2025.pdf, Cláusula 12."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -16,
        -64
      ],
      "id": "f0421588-8737-4706-b1e2-bfe9e7ac6990",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        -288,
        -64
      ],
      "id": "606aaa3d-157e-462b-9e65-75b841e29b26",
      "name": "When chat message received",
      "webhookId": "485a7520-e839-408c-8b98-48a051b03d08"
    },
    {
      "parameters": {
        "model": "gpt-oss:latest",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        -96,
        160
      ],
      "id": "eb29f2a8-b31e-4d5d-8696-dd3c63bc85d7",
      "name": "Ollama Chat Model",
      "credentials": {
        "ollamaApi": {
          "id": "xDcVkyu4yoySv92g",
          "name": "Credencial Ollama para localhost"
        }
      }
    },
    {
      "parameters": {
        "content": "## Alimentar la base de datos\n",
        "height": 672,
        "width": 576,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -944,
        -192
      ],
      "typeVersion": 1,
      "id": "137236dd-51ea-4320-8161-fb949337c2aa",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "contextWindowLength": 30
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        64,
        160
      ],
      "id": "d6494244-bf65-48e3-84b3-94c33392a81d",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Aqui puedes tomar los documentos cargados como base de información",
        "memoryKey": {
          "__rl": true,
          "mode": "list",
          "value": "vector_store_key"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.3,
      "position": [
        192,
        160
      ],
      "id": "2eaeb899-6acc-4881-9ac5-38239e3344be",
      "name": "Simple Vector Store1"
    }
  ],
  "pinData": {},
  "connections": {
    "cargar_docs": {
      "main": [
        [
          {
            "node": "Simple Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Ollama": {
      "ai_embedding": [
        [
          {
            "node": "Simple Vector Store",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "Simple Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Simple Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ollama Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Simple Vector Store1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "683861f1-4d3b-45e6-a0c6-cac85983245e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4758e594f2e1e717a035e18a7e437c95228375d6960d9224ec32486871c79d56"
  },
  "id": "ut0c41GxvpmEH0MNRnEDq",
  "tags": []
}